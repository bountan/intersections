<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Intersection Lookup</title>

<!--- libraries -->
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.11.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v1.11.0/mapbox-gl.css' rel='stylesheet' />
  <link rel="stylesheet" type="text/css" href="https://bountan.github.io/mobilitycovid/styles/styles-covid.css">
</head>
<body>

<!--- banner-->
  <div class="bannerimage">
    <div class="bannertext">
      <h1>Intersection Index</h1>
    </div>
  </div>

<!-- introtext -->


<!--- map object-->

<div id='map'></div>

<!-- console controls 
<div id='console'>-->

<!-- legend 
  <div class='session'>
    <h2>Total Zählungen</h2>
    <div class='row colors'></div>

    <div class='row' >
    <div class='label vol'>&nbsp&nbsp&nbsp&nbsp0 -<br>500</div>
    <div class='label vol'>&nbsp&nbsp500 -<br>2000</div>
    <div class='label vol'>&nbsp&nbsp2000 -<br>10000</div>
    <div class='label vol'>&nbsp&nbsp10000 -<br>50000</div>
    <div class='label vol'>50000+</div>
  </div>


-->

<!-- slider modetime
    <div class='session' id='sliderbar'><br>
<h2 class = 'paddingtop'>Kalenderwoche: <label id='active-week' >1</label></h2>
<h2 class = 'paddingtop'><label id='lockdownstat' >‏‏‎ ‎‎</label></h2>

  <input id='slider' class='row' type='range' min='1' max='52' step='1' value='1' />
</div>
  </div>

  <div class='session'>
    <h2>Verkehrsmodus</h2>
    <div class='row' id='filters'>
      <input id='ped' type='radio' name='toggle' value=1>
      <label for='ped'>Fussgänger</label><br>
      <input id='bike' type='radio' name='toggle' value=2>
      <label for='bike'>Velo</label>
    </div>
  </div>

</div>
-->



<!-- map controls -->
<script>

// basemap from mapbox
    mapboxgl.accessToken = 'pk.eyJ1IjoiYm91bnRhbiIsImEiOiJpSXVpaU1BIn0.pzuLQeLdLb3bRoYeQNc9jA';
    var map = new mapboxgl.Map({
      container: 'map',
      center: [12.564627, 55.686353],
      zoom: 15,
      minZoom: 10,
      maxZoom: 16,
      style: 'mapbox://styles/bountan/ckc9d897z432e1imtuzvbx928'
      //maxBounds: [[8.332501, 47.300210], [8.714815, 47.461794]]
    });


// map controls
    var scale = new mapboxgl.ScaleControl({
    maxWidth: 200,
    unit: 'metric'
    });
    map.addControl(scale);

    map.addControl(new mapboxgl.FullscreenControl());

// load map
//map.on('load', function() {

// variables filter what to display
//  var filterWeek = ['==', ['get', 'wk'], 1];
//  var filterMode = ['==', ['get', 'kind'], 1];
//  var modetext = "Fussgänger"

// add sections of traffic layer
  map.addLayer

//listener for slider change
  //document.getElementById('slider').addEventListener('input', function(e) {
  //var week = parseInt(e.target.value);




  //filterWeek = ["==", ['get', 'wk'], week]

  //map.setFilter('location', ['all', filterWeek, filterMode]
  //);

  // update text in the UI
  document.getElementById('active-week').innerText = week;


//  if (week < 12){
//      lockdown = "‏‏‎ ‎"
//    } else if (week < 20) {
//      lockdown = "Lockdown 16. März"
//    } else if (week < 28) {
//      lockdown = "Aufgehoben 11. Mai"
//    } else if (week < 43) {
//      lockdown = "Maskenpflicht 6. Juli"
//    } else {
//      lockdown = "Zweite Welle 19. Oktober"
//    }
//
//document.getElementById('lockdownstat').innerText = lockdown;
//});


// listener for button change

//document.getElementById('filters').addEventListener('change', function(e) {
//  var mode = parseInt(e.target.value);
//  if (mode == 1){
//    modetext = "Fussgänger"
//  } else if (mode == 2) {
//    modetext = "Velofahrer"
//  } else if (mode == 3){
//    modetext = "motorisierte Fahrzeuge"
//  }
//  else{
//    modetext = ""
//  }






//  filterMode = ["==", ['get', 'kind'], mode]
//  map.setFilter('location', ['all', filterWeek, filterMode]);
//});

// Add a layer to display the polygons
map.addLayer({
  id: 'intersections-layer',
  type: 'fill',
  source: 'https://bountan.github.io/mobilitycovid/data/intersections.geojson',
  layout: {},
  paint: {
    'fill-color': 'rgba(255, 0, 255, 0.5)', // Magenta color with 50% opacity
    'fill-outline-color': 'rgba(255, 0, 255, 1)' // Magenta outline
  }
});

// Add a click event listener to show popups with the "id" attribute
map.on('click', 'intersections-layer', function(e) {
  new mapboxgl.Popup()
    .setLngLat(e.lngLat)
    .setHTML(e.features[0].properties.id)
    .addTo(map);
});

////layer location, pretty static layer
//map.addLayer({
//  id: 'id',
//  type: 'polygon',
//  source: {
//    type: 'geojson',
//    data: 'https://bountan.github.io/mobilitycovid/data/intersections.geojson'
//    },
//
//  paint: {
//    'circle-color': 'red'
//
//
//}
//});
//
//// popup stops
//map.on('click', 'location', function(e) {
//new mapboxgl.Popup()
//.setLngLat(e.lngLat)
//.setHTML(e.features[0].properties.id)
//.addTo(map);
//});


</script>

</body>

</html>
